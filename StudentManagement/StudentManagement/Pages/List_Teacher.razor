@page "/list-teacher"
@using StudentManagement.NHibernate.Models
@using StudentManagement.gRPC.Services
@inject StudentManagement.NHibernate.DataAccess.NHibernateSessionManager NHSessionManager
@inject StudentManagement.gRPC.Services.GrpcServiceFactory GrpcFactory

<h3>List_Teacher</h3>

@if (teachers == null)
{
    <p>Loading teachers...</p>
}
else if (teachers.Any())
{
    <ul>
        @foreach (var teacher in teachers)
        {
            <li>@teacher.TenGV (@teacher.MaGV) - Ngày sinh: @teacher.NgaySinh</li>
        }
    </ul>
}
else
{
    <p>No teacher found.</p>
}

@code {
    private List<TeacherInfo> teachers = new();

    protected override async Task OnInitializedAsync()
    {
        try
        {
            var client = GrpcFactory.CreateGrpcClient(channel => new TeacherService.TeacherServiceClient(channel));
            var reply = await client.GetTeacherListAsync(new GetTeacherListRequest());
            teachers = reply.Teachers.ToList();
        }
        catch (Exception ex)
        {
            Console.WriteLine("Error retrieving teachers: " + ex.Message);
        }
    }
}
